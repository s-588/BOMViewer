// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
//go:generate templ generate

package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"context"
	"github.com/s-588/BOMViewer/internal/models"
)

// Update the function signature to accept TableControlsArgs
func Index(ctx context.Context, materials []models.Material, tableArgs MaterialTableArgs) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<html lang=\"ru\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>App title</title><link rel=\"stylesheet\" href=\"/static/css/bootstrap.min.css\"><script src=\"/static/js/bootstrap.bundle.min.js\"></script><script src=\"/static/js/htmx.min.js\"></script></head><body class=\"bg-light\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = header().Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<div id=\"alert-area\" class=\"position-fixed top-0 start-50 translate-middle-x mt-3\" style=\"min-width:300px; z-index:2000; display:none;\"></div><div class=\"container mb-5\" id=\"content\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = MainMaterialPage(materials, tableArgs).Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "</div><div id=\"modal-container\"></div></body><script>\r\n\t\t\t// Base64 decoder for UTF-8 strings (Cyrillic support)\r\n\t\t\tfunction decodeBase64(str) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// Decode base64 to binary string\r\n\t\t\t\t\tconst binaryString = atob(str);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Convert binary string to UTF-8 bytes\r\n\t\t\t\t\tconst bytes = new Uint8Array(binaryString.length);\r\n\t\t\t\t\tfor (let i = 0; i < binaryString.length; i++) {\r\n\t\t\t\t\t\tbytes[i] = binaryString.charCodeAt(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Decode UTF-8 bytes to string\r\n\t\t\t\t\treturn new TextDecoder('utf-8').decode(bytes);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.warn('Failed to decode base64, returning raw:', str);\r\n\t\t\t\t\treturn str;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Single event listener to handle all alerts\r\n\t\t\tdocument.body.addEventListener('htmx:beforeSwap', function(evt) {\r\n\t\t\t\tconst xhr = evt.detail.xhr;\r\n\t\t\t\t\r\n\t\t\t\t// Handle error messages\r\n\t\t\t\tif (evt.detail.isError) {\r\n\t\t\t\t\tconst errorMsg = xhr.getResponseHeader(\"HX-Error\");\r\n\t\t\t\t\tif (errorMsg) {\r\n\t\t\t\t\t\tshowAlert(\"danger\", decodeBase64(errorMsg));\r\n\t\t\t\t\t\tevt.detail.shouldSwap = false; // Don't swap content for errors\r\n\t\t\t\t\t\treturn; // Stop further processing\r\n\t\t\t\t\t}\r\n\t\t\t\t} \r\n\t\t\t\t// Handle success messages\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst successMsg = xhr.getResponseHeader(\"HX-Alert\");\r\n\t\t\t\t\tif (successMsg) {\r\n\t\t\t\t\t\tshowAlert(\"success\", decodeBase64(successMsg));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Fallback error handler (for errors without HX-Error header)\r\n\t\t\tdocument.body.addEventListener(\"htmx:responseError\", function (e) {\r\n\t\t\t\tconst xhr = e.detail.xhr;\r\n\t\t\t\t\r\n\t\t\t\t// If HX-Error header exists, it was already handled in beforeSwap\r\n\t\t\t\tif (xhr.getResponseHeader(\"HX-Error\")) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Handle special warning status\r\n\t\t\t\tif (xhr.status === 299) {\r\n\t\t\t\t\tshowAlert(\"warning\", xhr.response);\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t} \r\n\t\t\t\t// Fallback for other errors\r\n\t\t\t\telse {\r\n\t\t\t\t\tshowAlert(\"danger\", xhr.response || \"An error occurred\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tlet alertTimeout = null;\r\n\r\n\t\t\tfunction showAlert(type, message) {\r\n\t\t\t\tconst area = document.getElementById(\"alert-area\");\r\n\r\n\t\t\t\tif (alertTimeout) {\r\n\t\t\t\t\tclearTimeout(alertTimeout);\r\n\t\t\t\t\talertTimeout = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst icon = getIcon(type);\r\n\r\n\t\t\t\tarea.innerHTML = `\r\n\t\t\t\t\t<div class=\"alert alert-${type} alert-dismissible shadow-lg fade show d-flex align-items-center gap-2 mb-0\" role=\"alert\" style=\"border-radius: .75rem;\">\r\n\t\t\t\t\t\t<i class=\"bi ${icon} fs-4\"></i>\r\n\t\t\t\t\t\t<div class=\"flex-fill\">${message}</div>\r\n\t\t\t\t\t\t<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"></button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`;\r\n\r\n\t\t\t\tarea.style.display = \"block\";\r\n\r\n\t\t\t\talertTimeout = setTimeout(() => {\r\n\t\t\t\t\tarea.innerHTML = \"\";\r\n\t\t\t\t\tarea.style.display = \"none\";\r\n\t\t\t\t}, 8000);\r\n\t\t\t}\r\n\r\n\t\t\tfunction getIcon(type) {\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase \"danger\": return \"bi-exclamation-octagon-fill\";\r\n\t\t\t\t\tcase \"warning\": return \"bi-exclamation-triangle-fill\";\r\n\t\t\t\t\tcase \"success\": return \"bi-check-circle-fill\";\r\n\t\t\t\t\tcase \"info\": return \"bi-info-circle-fill\";\r\n\t\t\t\t\tdefault: return \"bi-exclamation-circle-fill\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Initialize Bootstrap components\r\n\t\t\tfunction initializeBootstrapComponents() {\r\n\t\t\t\tdocument.querySelectorAll('[data-bs-toggle=\"popover\"]').forEach(el => {\r\n\t\t\t\t\tnew bootstrap.Popover(el);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tdocument.addEventListener('DOMContentLoaded', initializeBootstrapComponents);\r\n\t\t\tdocument.body.addEventListener('htmx:afterSwap', initializeBootstrapComponents);\r\n\t\t</script></html>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
